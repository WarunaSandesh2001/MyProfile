<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>POS System</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand fw-bolder text-white brandName" href="#">POS System</a>
        <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
                class="navbar-toggler"
                data-bs-target="#navbarSupportedContent" data-bs-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item" id="navHome">
                    <a aria-current="page" class="nav-link active" style="cursor: pointer">Home</a>
                </li>
                <li class="nav-item" id="navCustomer">
                    <a aria-current="page" class="nav-link active" style="cursor: pointer">Customers</a>
                </li>
                <li class="nav-item" id="navOrders">
                    <a aria-current="page" class="nav-link active" style="cursor: pointer">Orders</a>
                </li>
                <li class="nav-item" id="navItem">
                    <a aria-current="page" class="nav-link active" style="cursor: pointer">Items</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<section id="home">
    <div class="text-center" style="height: 100vh; width: 100vw; background-color: black">
        <!--<img alt="wholesale image" class="img-fluid mt-5" src="assets/img/wholesaleAPI.jpg">-->
        <!--        <h1 class="text-center mt-5" style="color: white">Sandesh WholeSales</h1>-->

        <div class="col-10 col-lg-5 px-0 mx-auto">
            <div class="carousel slide" data-bs-ride="carousel" id="carouselExampleCaptions">
                <div class="carousel-indicators">
                    <button aria-current="true" aria-label="Slide 1" class="active" data-bs-slide-to="0"
                            data-bs-target="#carouselExampleCaptions" type="button"></button>
                    <button aria-label="Slide 2" data-bs-slide-to="1" data-bs-target="#carouselExampleCaptions"
                            type="button"></button>
                    <button aria-label="Slide 3" data-bs-slide-to="2" data-bs-target="#carouselExampleCaptions"
                            type="button"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img alt="..." class="d-block w-100" src="assets/img/wholesaleAPI.jpg">
                        <div class="carousel-caption d-none d-md-block">
                            <h5>First slide label</h5>
                            <p>Some representative placeholder content for the first slide.</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img alt="..." class="d-block w-100" src="assets/img/wholesale-shipping.jpg">
                        <div class="carousel-caption d-none d-md-block">
                            <h5>Second slide label</h5>
                            <p>Some representative placeholder content for the second slide.</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img alt="..." class="d-block w-100" src="assets/img/wholesaleAPI.jpg">
                        <div class="carousel-caption d-none d-md-block">
                            <h5>Third slide label</h5>
                            <p>Some representative placeholder content for the third slide.</p>
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" data-bs-slide="prev" data-bs-target="#carouselExampleCaptions"
                        type="button">
                    <span aria-hidden="true" class="carousel-control-prev-icon"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" data-bs-slide="next" data-bs-target="#carouselExampleCaptions"
                        type="button">
                    <span aria-hidden="true" class="carousel-control-next-icon"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
        <h1 class="text-center mt-5" style="color: white">Sandesh WholeSales</h1>
    </div>


</section> <!--Home-->
<section id="customer">
    <h2 class="text-dark mt-4">Customer</h2>

    <section class="container overflow-hidden">
        <button class="badge bg-dark mt-1 btn btn-primary" data-bs-target="#exampleModal" data-bs-toggle="modal"
                data-bs-whatever="@getbootstrap" type="button">Add new Customer
        </button>
        <button class="badge bg-danger mt-1">View all customers</button>
        <div class="align bg-light mt-1">
            <h4 class="mt-3" style="background-color: #4ed429">Search Customer</h4>

            <!--<form class="row gy-2 gx-3 align-items-center">-->
                <div class="col-auto">
                    <!--<label class="visually-hidden" for="autoSizingInput">Name</label>-->
                    <input class="form-control" id="txtSearchCusID" placeholder="search"
                           type="text" style="width: 500px">
                    <!--<input class="form-control" id="txtSearchCusID1" placeholder="search"
                           type="text">
                    <input type="text" placeholder="search" style="width: 500px">-->
                </div>
                <!--<div class="col-auto">
                    <label class="visually-hidden" for="autoSizingSelect">Preference</label>
                    <select class="form-select" id="autoSizingSelect">
                        <option value="1">Name</option>
                        <option value="2">NIC</option>
                        <option value="3">Address</option>
                    </select>
                </div>-->
                <div class="col-auto">
                    <button class="btn btn-primary" type="button" id="btnSearch">Search</button>
                </div>
                <div>
                    <button class="btn btn-primary mt-1" id="updateCustomer" style="background: #0138d9" type="reset" data-bs-target="#exampleModal" data-bs-toggle="modal"
                            data-bs-whatever="@getbootstrap">Update</button>
                    <button class="btn btn-primary mt-1" id="deleteCustomer"  style="background: #ee0216" type="reset">Delete</button>
                </div>
           <!-- </form>-->
        </div>
    </section>

    <section>

        <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal" tabindex="-1" >
            <div class="modal-dialog">
                <div class="modal-content" style="background-color: #162238">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel" style="color: white; font-weight: bolder">New
                            Customer</h5>
                        <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="mb-3">
                                <label class="col-form-label" for="custID" style="color: white;">Customer ID:</label>
                                <input class="form-control" id="custID" type="text">
                                <p><small class="text-danger pl-1" id="lblcusid"></small></p>
                            </div>
                            <div class="mb-3">
                                <label class="col-form-label" for="custName" style="color: white;">Customer
                                    Name:</label>
                                <input class="form-control" id="custName" type="text">
                                <p><small class="text-danger pl-1" id="lblcusname"></small></p>
                            </div>
                            <div class="mb-3">
                                <label class="col-form-label" for="nic" style="color: white;">Customer NIC:</label>
                                <input class="form-control" id="nic" type="text">
                                <p><small class="text-danger pl-1" id="lblcusNIC"></small></p>
                            </div>
                            <div class="mb-3">
                                <label class="col-form-label" for="address" style="color: white;">Customer
                                    Address:</label>
                                <input class="form-control" id="address" type="text">
                                <p><small class="text-danger pl-1" id="lblcusAddress"></small></p>
                            </div>

                            <div class="mb-3">
                                <label class="col-form-label" for="contact" style="color: white;">Customer
                                    Contact:</label>
                                <input class="form-control" id="contact" type="text">
                                <p><small class="text-danger pl-1" id="lblcusContact"></small></p>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal" style="background-color: #565e64"
                                type="button">Close
                        </button>
                        <button class="btn btn-primary" style="background-color: darkgreen" type="button" id="renew">Renew</button>
                        <button class="btn btn-primary" id="btnSaveOrUpdate" style="background-color: darkblue"
                                type="button">Save Customer
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="shadow-lg">
        <div class="col" >
            <table class="table table-dark table-striped table-hover mt-5">
                <thead class="bg-danger text-white">
                <tr>
                    <th>Customer ID</th>
                    <th>Customer Name</th>
                    <th>NIC</th>
                    <th>Address</th>
                    <th>Contact</th>
                </tr>
                </thead>
                <tbody id="customerTable">


                </tbody>
            </table>
        </div>
    </section>
</section> <!--customer-->
<section id="item">


    <div class="m-2">
        <h2 class="text-dark mt-4">Item</h2>
    </div>


    <section class="container overflow-hidden">
        <div class="container flex-row d-flex justify-content-end ">
            <button class="badge bg-dark mt-1 btn btn-primary" data-bs-target="#exampleModal1" data-bs-toggle="modal"
                    data-bs-whatever="@getbootstrap" type="button">Add new Item
            </button>
            <button class="badge bg-danger mt-1 ">View all Items</button>
        </div>

        <div class="align bg-light mt-1">
            <h4 class="mt-3" style="background-color: #4ed429">Search Item</h4>

                <div class="col-auto">
                    <input class="form-control" id="txtItemID" placeholder="search"
                           type="text" style="width: 500px">
                </div>
               <!-- <div class="col-auto">
                    <label class="visually-hidden" for="autoSizingSelect">Preference</label>
                    <select class="form-select" id="autoSizingSelect">
                        <option value="1">Name</option>
                        <option value="2">price</option>
                    </select>
                </div>-->
                <div class="col-auto">
                    <button class="btn btn-primary" type="submit">Search</button>
                </div>
                <div>
                    <button class="btn btn-primary mt-1" style="background: #010bc9" type="reset" id="updateItem" data-bs-target="#exampleModal1" data-bs-toggle="modal"
                            data-bs-whatever="@getbootstrap">Update</button>
                    <button class="btn btn-primary mt-1" style="background: #ee0216" type="reset" id="deleteItem">Delete</button>
                </div>
        </div>
    </section>

    <section class="shadow-lg">
        <div class="col">
            <table class="table table-dark table-striped table-hover mt-5">
                <thead class="bg-danger text-white">
                <tr>
                    <th>Item Code</th>
                    <th>Item Name</th>
                    <th>Price (Rs)</th>
                    <th>Quantity</th>
                </tr>
                </thead>
                <tbody id="itemTable">


                </tbody>
            </table>
        </div>
    </section>

    <section>

        <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal1" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content" style="background-color: #162238">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel2" style="color: white; font-weight: bolder">New
                            Item</h5>
                        <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="mb-3">
                                <label class="col-form-label" for="iCode" style="color: white">Item Code:</label>
                                <input class="form-control" id="iCode" type="text">
                            </div>
                            <div class="mb-3">
                                <label class="col-form-label" for="itemName" style="color: white">Item Name:</label>
                                <input class="form-control" id="itemName" type="text">
                            </div>
                            <div class="mb-3">
                                <label class="col-form-label" for="Iprice" style="color: white">Item Price:</label>
                                <input class="form-control" id="Iprice" type="text">
                            </div>
                            <div class="mb-3">
                                <label class="col-form-label" for="Iqty" style="color: white">Item Quantity:</label>
                                <input class="form-control" id="Iqty" type="text">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal" style="background-color: #565e64"
                                type="button">Close
                        </button>
                        <button class="btn btn-primary" style="background-color: darkgreen" type="button" id="renewItem">Renew</button>
                        <button class="btn btn-primary" id="saveItem" style="background-color: darkblue" type="button">
                            Save Item
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
</section> <!--Item-->
<section id="orders">
    <h3 class="mt-4">Order Form</h3>
    <section class="row d-flex flex-row justify-content-around">

        <div class="shadow-lg col-4 mt-2" style="width: 500px; height:400px; border: 3px solid #4ed429">
            <div style="background-color: #1a1e21; height: 26px; width: 100%">
                <h5 class="mt-2" style="color: white">Invoice Details</h5>
            </div>

            <div class="row">
                <div class="col-md-6 mt-1">
                    <label class="form-label" for="inputOrderID">Order ID</label>
                    <input class="form-control" id="inputOrderID" type="email">
                </div>
                <div class="col-md-6 mt-1">
                    <label class="form-label" for="inputDate">Date</label>
                    <input class="form-control" id="inputDate" type="date">
                </div>
                <div class="col-md-6 mt-2">
                    <label class="form-label" for="inputState">Customer ID</label>
                    <select class="form-select" id="inputState">
                        <!-- <option>C001</option>
                         <option>C002</option>
                         <option>C003</option>-->
                    </select>
                </div>
                <div class="col-md-6 mt-2">
                    <label class="form-label" for="inputId">ID</label>
                    <input class="form-control" id="inputId" type="text">
                </div>
                <div class="col-md-6 mt-2">
                    <label class="form-label" for="inputName">Name</label>
                    <input class="form-control" id="inputName" type="text">
                </div>
                <div class="col-md-6 mt-2">
                    <label class="form-label" for="inputContact">Contact</label>
                    <input class="form-control" id="inputContact" type="text">
                </div>
                <div class="col-md-12 mt-2">
                    <label class="form-label" for="inputAddress">Address</label>
                    <input class="form-control" id="inputAddress" type="text">
                </div>
            </div>
        </div>

        <div class="shadow-lg col-4 mt-2" style="width: 500px; height: 400px; background-color:#a8a8a8">
            <div style="background-color: #1a1e21; height: 28px; width: 100%">
                <h5 class="mt-2" style="color: white">Item Select</h5>
            </div>


            <div class="row">
                <div class="col-md-6 mt-2">
                    <label class="form-label" for="selectItem">Item</label>
                    <select class="form-select" id="selectItem">
                        <!--<option>I001</option>
                        <option>I002</option>
                        <option>I003</option>-->
                    </select>
                </div>
                <div class="col-md-6 mt-1">
                    <label class="form-label" for="inputItemCode">Item Code</label>
                    <input class="form-control" id="inputItemCode" type="text">
                </div>
                <div class="col-md-4 mt-2">
                    <label class="form-label" for="inputIName">Name</label>
                    <input class="form-control" id="inputIName" type="text">
                </div>
                <div class="col-md-4 mt-2">
                    <label class="form-label" for="inputQTY">Qty On Hand</label>
                    <input class="form-control" id="inputQTY" type="text">
                </div>
                <div class="col-md-4 mt-2">
                    <label class="form-label" for="inputPrice">Price</label>
                    <input class="form-control" id="inputPrice" type="text">
                </div>
                <div class="col-md-12 mt-2">
                    <label class="form-label" for="inputOrderQTY">Order Quantity</label>
                    <input class="form-control" id="inputOrderQTY" type="text">
                </div>
                <div class="row mt-3 m-1">
                    <button class="btn btn-primary mt-1" id="btnAddToCart"
                            style="font-family: Times; font-weight: bolder; background-color: #14b414"
                            type="reset">Add To Cart
                    </button>
                </div>
            </div>
        </div>

        <div class="shadow-lg col-3 mt-2"
             style="width: 500px; height: 400px; background-color:#020101;  border: 3px solid #000000">
            <div class="mt-3 m-4">
                <h5 id="totalPrice" style="color: #fcfcfc; font-family: 'Adobe Fangsong Std R'; font-size: 35px">Total
                    Price :
                    Rs.0.00 </h5>
                <h5 id="subTotal" style="color: #ce0303; font-family: 'Times New Roman'; font-size: 35px">Sub Total- :
                    Rs.0.00 </h5>
            </div>

            <div class="row">
                <div class="col-md-6 mt-2">
                    <label class="form-label" for="inputDiscount" style="color: white">Discount (Rs)</label>
                    <input class="form-control" id="inputDiscount" type="text">
                </div>

                <div class="col-md-6 mt-2">
                    <label class="form-label" for="inputCash" style="color: white">Cash (Rs)</label>
                    <input class="form-control" id="inputCash" type="text">
                </div>

                <div class="col-md-12 mt-2">
                    <label class="form-label" for="inputBalance" style="color: white" >Balance (Rs)</label>
                    <input class="form-control" id="inputBalance" type="text" >
                </div>

                <div class="d-flex flex-row justify-content-center mt-4">
                    <button class="btn btn-primary mt-1" id="purchase"
                            style="font-weight: bolder; background-color: #031dc9"
                            type="reset">Purchase
                    </button>
                </div>

            </div>


        </div>

    </section>

    <section class="shadow-lg">
        <table class="table table-dark table-striped table-hover mt-5 bg-light">
            <thead>
            <tr>
                <th scope="col">Item Code</th>
                <th scope="col">Item Name</th>
                <th scope="col">Quantity</th>
                <th scope="col">Price(per unit)</th>
                <th scope="col">Total (Rs)</th>
            </tr>
            </thead>
            <tbody id="orderTable">

            </tbody>
        </table>

    </section>
</section> <!--Orders-->

<script src="assets/jQuery/jquery-3.6.0.min.js"></script>
<script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="db/db.js"></script>
<script src="model/CustomerDTO.js"></script>
<script src="model/ItemDTO.js"></script>
<script src="model/OrderDetailDTO.js"></script>
<script src="model/OrderDTO.js"></script>
<script src="assets/sweet%20alert/sweetalert.min.js"></script>
<script src="controller/CustomerController.js"></script>
<script src="controller/ItemController.js"></script>

<script>

    document.getElementById("home").style.display = "block";
    document.getElementById("customer").style.display = "none";
    document.getElementById("item").style.display = "none";
    document.getElementById("orders").style.display = "none";

    document.getElementById("navHome").addEventListener("click", function () {
        document.getElementById("home").style.display = "block";
        document.getElementById("customer").style.display = "none";
        document.getElementById("item").style.display = "none";
        document.getElementById("orders").style.display = "none";
    });

    document.getElementById("navCustomer").addEventListener("click", function () {
        document.getElementById("home").style.display = "none";
        document.getElementById("customer").style.display = "block";
        document.getElementById("item").style.display = "none";
        document.getElementById("orders").style.display = "none";
    });

    document.getElementById("navItem").addEventListener("click", function () {
        document.getElementById("home").style.display = "none";
        document.getElementById("customer").style.display = "none";
        document.getElementById("item").style.display = "block";
        document.getElementById("orders").style.display = "none";
    });

    document.getElementById("navOrders").addEventListener("click", function () {
        document.getElementById("home").style.display = "none";
        document.getElementById("customer").style.display = "none";
        document.getElementById("item").style.display = "none";
        document.getElementById("orders").style.display = "block";

        setCustomerIdsToComboBox();
        setItemIdsToComboBox();
    });

    // Customer form Validation and save

    // Item Form Validation and save

    // Order Form Validation and save
    {
        $("#inputId").attr("disabled", true);
        $("#inputName").attr("disabled", true);
        $("#inputContact").attr("disabled", true);
        $("#inputAddress").attr("disabled", true);

        $("#inputItemCode").attr("disabled", true);
        $("#inputIName").attr("disabled", true);
        $("#inputQTY").attr("disabled", true);
        $("#inputPrice").attr("disabled", true);

        $("#inputBalance").attr("disabled", true);
        $("#inputCash").attr("disabled", true);
        $("#purchase").attr("disabled", true);

        var ifExistsCustomer = false;
        var ifExistsItem = false;
        let selectedItem;
        let total = 0.00;
        let subTotal = 0.00;
        let orderDetailObject;

        function setCustomerIdsToComboBox() {
            $("#inputState").empty();
            $("#inputState").append(new Option("-Select Customer-", ""));
            for (let i = 0; i < customerDB.length; i++) {
                $("#inputState").append(new Option(customerDB[i].getID(), i));
            }
        }

        $("#inputState").change(function () {
            var id = $("#inputState").find('option:selected').text();
            let searchCustomer1 = searchCustomer(id);
            if (searchCustomer1) {
                ifExistsCustomer = true;
                $("#inputId").val(searchCustomer1.getID());
                $("#inputName").val(searchCustomer1.getName());
                $("#inputContact").val(searchCustomer1.getContact());
                $("#inputAddress").val(searchCustomer1.getAddress());
            }
            if (ifExistsCustomer == false) {
                $("#inputId").val("");
                $("#inputName").val("");
                $("#inputContact").val("");
                $("#inputAddress").val("");
            }

        });

        function searchCustomer(id) {
            for (let i = 0; i < customerDB.length; i++) {
                if (customerDB[i].getID() == id) {
                    ifExistsCustomer = true;
                    return customerDB[i];
                }
            }
            ifExistsCustomer = false;
        }

        function setItemIdsToComboBox() {
            $("#selectItem").empty();
            $("#selectItem").append(new Option("-Select Item-", ""));
            for (let i = 0; i < itemDB.length; i++) {
                $("#selectItem").append(new Option(itemDB[i].getItemCode(), i));
            }
        }

        $("#selectItem").change(function () {
            var id = $("#selectItem").find('option:selected').text();
            let searchItem1 = searchItem(id);
            if (searchItem1) {
                ifExistsItem = true;
                selectedItem = searchItem1;
                $("#inputItemCode").val(searchItem1.getItemCode());
                $("#inputIName").val(searchItem1.getItemName());
                $("#inputQTY").val(searchItem1.getItemQTY());
                $("#inputPrice").val(searchItem1.getPrice());
            }
            if (ifExistsItem == false) {
                $("#inputItemCode").val("");
                $("#inputIName").val("");
                $("#inputQTY").val("");
                $("#inputPrice").val("");
            }

        });

        function searchItem(id) {
            for (let i = 0; i < itemDB.length; i++) {
                if (itemDB[i].getItemCode() == id) {
                    ifExistsCustomer = true;
                    return itemDB[i];
                }
            }
            ifExistsItem = false;
        }

        function loadAllOrders() {
            $("#orderTable").empty();
            for (var i of OrderDetailsDB) {
                let row = `<tr><td>${i.getItemCodeOfDetails()}</td><td>${i.getItemNameOfDetails()}</td><td>${i.getOrderQTY()}</td><td>${i.getPricePerUnit()}</td><td>${i.getTPrice()}</tr>`;
                $("#orderTable").append(row);
            }
        }

        $("#btnAddToCart").click(function () {
            let OID = $("#inputOrderID").val();
            let orderQTY = $("#inputOrderQTY").val();
            total = total + orderQTY * selectedItem.getPrice();

            orderDetailObject = new OrderDetailDTO(OID, selectedItem.getItemCode(), selectedItem.getItemName(), orderQTY, selectedItem.getPrice(), total);
            tempArray.push(orderDetailObject);
            loadAllOrders();

            $("#totalPrice").text("Total Price : Rs." + total);
            $("#subTotal").text("Sub Price- : Rs." + total);
        });

        $("#inputDiscount").on('keyup', function (eventOb) {
            if (eventOb.key == "Enter") {
                let discount = $("#inputDiscount").val();
                subTotal = total - discount;
                $("#subTotal").text("Sub Price- : Rs." + subTotal);
                $("#inputCash").attr("disabled", false);
            }
        });
        $("#inputCash").on('keyup', function (eventOb) {
            if (eventOb.key == "Enter") {
                let cash = $("#inputCash").val();
                $("#inputBalance").val((cash - subTotal));
                $("#purchase").attr("disabled", false);
            }
        });

        $("#purchase").click(function () {
            let res = confirm("Do you want to place the Order..?");
            if (res) {
                let OID = $("#inputOrderID").val();
                let date = $("#inputDate").val();
                let orderObject = new OrderDTO(OID, date, subTotal, orderDetailObject);
                OrderDB.push(orderObject);
                for (i = 0; i < tempArray.length; i++) {
                    OrderDetailsDB.push(tempArray[i]);
                }
            }
            $("#inputBalance").attr("disabled", true);

        });
    }
</script>

</body>
</html>